{
   "$schema": "https://raw.githubusercontent.com/oasis-tcs/sarif-spec/master/Schemata/sarif-schema-2.1.0.json",
   "version": "2.1.0",
   "runs": [
      {
         "automationDetails": {
            "id": "supply-chain/local/eb448e924a8d547194245827aa9b0006d23b9a41-01 Dec 21 19:58 -0800"
         },
         "tool": {
            "driver": {
               "name": "Scorecard",
               "informationUri": "https://github.com/ossf/scorecard",
               "semanticVersion": "3.1.1-82-geb448e9-dirty",
               "rules": [
                  {
                     "id": "Token-Permissions",
                     "name": "Token-Permissions",
                     "helpUri": "https://github.com/ossf/scorecard/blob/eb448e924a8d547194245827aa9b0006d23b9a41/docs/checks.md#token-permissions",
                     "shortDescription": {
                        "text": "Token-Permissions"
                     },
                     "fullDescription": {
                        "text": "Determines if the project's workflows follow the principle of least privilege."
                     },
                     "help": {
                        "text": "Determines if the project's workflows follow the principle of least privilege.",
                        "markdown": "**Remediation**:\n\n- Set permissions as `read-all` or `contents: read` as described in GitHub's [documentation](https://docs.github.com/en/actions/reference/workflow-syntax-for-github-actions#permissions).\n\n\n\n**Severity**: High\n\n\n\n**Details**:\n\nRisk: `High` (vulnerable to malicious code additions)\n\n\n\nThis check determines whether the project's automated workflows tokens are set\n\nto read-only by default. It is currently limited to repositories hosted on\n\nGitHub, and does not support other source hosting repositories (i.e., Forges).\n\n\n\nSetting token permissions to read-only follows the principle of least privilege.\n\nThis is important because attackers may use a compromised token with write\n\naccess to push malicious code into the project.\n\n\n\nThe highest score is awarded when the permissions definitions in each workflow's\n\nyaml file are set as read-only at the\n\n[top level](https://docs.github.com/en/actions/reference/workflow-syntax-for-github-actions#permissions)\n\nand the required write permissions are declared at the\n\n[run-level](https://docs.github.com/en/actions/reference/workflow-syntax-for-github-actions#jobsjob_idpermissions).\n\n        \n\nThe check cannot detect if the \"read-only\" GitHub permission setting is\n\nenabled, as there is no API available.   \n\n"
                     },
                     "defaultConfiguration": {
                        "level": "error"
                     },
                     "properties": {
                        "precision": "high",
                        "problem.severity": "error",
                        "security-severity": "7.0",
                        "tags": [
                           "supply-chain",
                           "security",
                           "infrastructure"
                        ]
                     }
                  }
               ]
            }
         },
         "results": [
            {
               "ruleId": "Token-Permissions",
               "ruleIndex": 0,
               "message": {
                  "text": "non read-only tokens detected in GitHub workflows"
               },
               "locations": [
                  {
                     "physicalLocation": {
                        "artifactLocation": {
                           "uri": ".github/scorecard-policy.yml",
                           "uriBaseId": "%SRCROOT%"
                        }
                     }
                  }
               ]
            }
         ]
      }
   ]
}
